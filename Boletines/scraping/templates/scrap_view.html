<!DOCTYPE html>
{% extends 'main.html' %}

{% block content %}

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scrap</title>
</head>
<body>
    <div id="main">
        <h1>Webscraping Requests</h1>
        <p> Esta sección va a ser la encargada de realizar las solicitudes de webscraping a la fuentes a utilizar para poder recopilar
            las nuevas noticias que se vayan lanzando en los sitios. Por ahora solamente es funcional con la página https://www.1pointfive.com/news,
            además de que solamente se mostrarán los resultados de la aplicación de webscrap por ahora.<br>
            Si quiere revisar el contenido de las noticias puede hacer uso del siguiente boton (la pagina puede demorar un poco en cargar): 
        <p>
        <form action="/scrap/news" method="get">
            <button type="submit">Revisar contenido de noticias</button>
            <button id="update-database-button">Actualizar Base de Datos</button>
        </form>

        <script>
            document.getElementById("update-database-button").addEventListener("click", function() {
                fetch("{% url 'update_database' %}", {
                    method: "POST",
                    headers: {
                        "X-CSRFToken": "{{ csrf_token }}"
                    },
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert(data.message);
                    } else {
                        alert("Error: " + data.message);
                    }
                })
                .catch(error => console.error("Error:", error));
            });
        </script>

        {% if interests %}
        {% for interest in interests %}
        <h2>{{interest.title}}</h2>
        <p>{{interest.link}}</p><br>
        {% endfor %}
        {% endif %}
    </div>
</body>
</html>

{% endblock %}